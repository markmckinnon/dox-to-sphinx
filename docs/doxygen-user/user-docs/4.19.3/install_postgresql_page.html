<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: Install and Configure PostgreSQL</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autopsy User Documentation<span id="projectnumber">&#160;4.19.3</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Install and Configure PostgreSQL </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="install_post_over"></a>
Overview</h1>
<p>In a multi-user case, a central PostgreSQL database server is used instead of the embedded SQLite databases. <br  />
</p>
<p>A new database will be created for each case and the database will be stored in a location you choose during installation. It is recommended that you choose a drive that is local to the machine and is not the system drive.</p>
<p>You should ensure that the database folder is backed up.</p>
<h1><a class="anchor" id="install_post_install"></a>
Installation</h1>
<p>To install PostgreSQL, perform the following steps:</p>
<ol type="1">
<li>Download a 64-bit PostgreSQL installer from <a href="https://www.enterprisedb.com/downloads/postgres-postgresql-downloads">https://www.enterprisedb.com/downloads/postgres-postgresql-downloads</a> Choose one under Windows x86-64. Autopsy has been tested with PostgreSQL version 9.5.</li>
<li>Run the installer. The name will be similar to <em>postgresql-9.5.3-1-windows-x64.exe</em>.</li>
<li>You may accept defaults for all items except for the password and the database storage location as you work through the wizard. Do not lose the password you enter in. This is the PostgreSQL administrator login password.</li>
<li>You do not need to launch the StackBuilder nor acquire any more software from it. Uncheck the option to use StackBuilder and press <em>Finish</em>.</li>
</ol>
<h1><a class="anchor" id="install_post_config"></a>
Configuration</h1>
<ol type="1">
<li>Create a regular database user account that Autopsy will use. You can do this with either of two methods, graphically, or command line. We cover graphically here.</li>
</ol>
<ul>
<li>Use the pgAdmin III tool and login with the PostgreSQL administrator login.</li>
<li>Right click on <em>"Login Roles"</em> and select <em>"New Login Role..."</em> as shown below: <br  />
<br  />
 <div class="image">
<img src="pgAdmin.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Enter the user name you would like to use in the <em>"Role name"</em> field. <br  />
<br  />
 <div class="image">
<img src="newLoginRole.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Enter the password on the <em>"Definition"</em> tab. <br  />
<br  />
 <div class="image">
<img src="newPassword.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>For <em>"Role Privileges"</em>, give the user <em>"Can Login?"</em> and <em>"Can create databases"</em>. <br  />
<br  />
 <div class="image">
<img src="newRights.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Click <em>"OK"</em>.</li>
</ul>
<ol type="1">
<li>Edit <em>C:\Program Files\PostgreSQL\9.5\data\pg_hba.conf</em> to add an entry to allow external computers to connect via the network. <br  />
<br  />
 First, find your machine's IPv4 address and Subnet Mask (Press <em>Start</em>, type <em>cmd</em>, type <em>ipconfig</em> and parse the results. The IP address is shown in yellow below. <br  />
 <div class="image">
<img src="postgresqlinstall3.PNG" alt=""/>
</div>
 <br  />
 The following is an example rule that allows all clients on the 10.10.192.x subnet to connect using md5 authentication. <br  />
 <blockquote class="doxtable">
<p>&zwj;host&#160;&#160;&#160;&#160;&#160;&#160;all&#160;&#160;&#160;&#160;&#160;&#160;all&#160;&#160;&#160;&#160;&#160;&#160;10.10.192.0/24&#160;&#160;&#160;&#160;&#160;&#160;md5 </p>
</blockquote>
<br  />
 <b>Subnet Mask Rules of thumb:</b><ul>
<li>If your Subnet Mask is 255.255.0.0, your rule should look like this: A.B.0.0/16, where A is the first octet in your IP address and B is the second octet. <br  />
</li>
<li>If your Subnet Mask is 255.255.255.0, your rule should look like this: A.B.C.0/24, where A is the first octet in your IP address, B is the second octet, and C is the third octet. <br  />
<br  />
 Add the line highlighted in yellow below, formatted with spaces between the entries, adjusting the IP address to an appropriate value as described above. <br  />
<br  />
 <div class="image">
<img src="postgresqlinstall4.PNG" alt=""/>
</div>
 <br  />
 <br  />
<br  />
 If you intend to use PostgreSQL from machines on a different subnet, you need an entry in the <em>pg_hba.conf</em> file for each subnet. <br  />
<br  />
</li>
</ul>
</li>
<li>Uncomment the following entires in the configuration file located at <em>C:\Program Files\PostgreSQL\9.5\data\postgresql.conf</em> by removing the leading "#", and change their values <em>"off"</em> as shown below. <br  />
 <blockquote class="doxtable">
<p>&zwj; fsync = off<br  />
 synchronous_commit = off<br  />
 full_page_writes = off<br  />
 </p>
</blockquote>
<br  />
 Pictorially, change the following, from this: <br  />
<br  />
 <div class="image">
<img src="postgresqlinstall5.PNG" alt=""/>
</div>
 <br  />
<br  />
 To this: <br  />
<br  />
 <div class="image">
<img src="postgresqlinstall6.PNG" alt=""/>
</div>
 <br  />
<br  />
 Note the removal of the leading number symbol-this uncomments that entry. <br  />
<br  />
</li>
<li>Still in <em id="max_connections">"C:\Program Files\PostgreSQL\9.5\data\postgresql.conf"</em>, find the entry named <em>max_connections</em> and set it to the number of suggested connections for your configuration. A rule of thumb is 100 connections per each Automated Ingest node and reviewer node. See the screenshot below. <br  />
<br  />
 <div class="image">
<img src="maxConnections.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Restart the service via the Services panel by pressing <em>Start</em>, type <em>services.msc</em>, and press <em>Enter</em>. Select <em>postgresql-x64-9.5</em> in the services list and click the link that says <em>Stop the service</em>. If you want PostgreSQL to run as a different user (you don't need to), then make that change now. When done, click the link that says <em>Start the service</em> as shown in the screenshot below. <br  />
<br  />
 <div class="image">
<img src="postgresqlinstall7.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Add the bin\postgres.exe file to the Windows firewall to allow it to receive connections.</li>
</ol>
<h1><a class="anchor" id="install_post_test"></a>
Testing</h1>
<p>You can verify that PostgreSQL is running by using either the <em>pgAdmin</em> tool or the <em>psql</em> tool to connect to the database server from another machine on the network.</p>
<p>Common problems are typically the result of:</p><ul>
<li>Firewall blocking the port (default: 5432) on the PostgreSQL server.</li>
<li>Incorrectly configured database user account or incorrect credentials.</li>
<li>Incorrectly configured IP address range in pg_hba.conf file.</li>
</ul>
<h1><a class="anchor" id="install_post_backup"></a>
Backing Up</h1>
<p>The databases and configuration files are stored at the location you chose during PostgreSQL installation (not shared storage). So, you should backup that directory periodically.</p>
<p>For an installation where the default options were chosen, the directory can be found at C:\Program Files\PostgreSQL\9.5\data. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr/>
<p><i>Copyright &#169; 2012-2022 Basis Technology. Generated on Fri Feb 24 2023<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
