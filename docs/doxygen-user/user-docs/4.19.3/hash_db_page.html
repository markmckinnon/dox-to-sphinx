<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: Hash Lookup Module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autopsy User Documentation<span id="projectnumber">&#160;4.19.3</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Autopsy User&#39;s Guide</a></li><li class="navelem"><a class="el" href="quick_start_guide.html">Quick Start Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Hash Lookup Module </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md26">What Does It Do</a></li>
<li class="level1"><a href="#autotoc_md27">Configuration</a></li>
<li class="level1"><a href="#adding_hashsets">Importing Hash Sets</a><ul><li class="level2"><a href="#hashset_indexing">Indexing</a></li>
</ul>
</li>
<li class="level1"><a href="#creating_hashsets">Creating Hash Sets</a></li>
<li class="level1"><a href="#hash_adding_hashes">Adding Hashes to a Hash Set</a></li>
<li class="level1"><a href="#using_hashsets">Using Hash Sets</a><ul><li class="level2"><a href="#autotoc_md28">NIST NSRL</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md29">Using the Module</a><ul><li class="level2"><a href="#autotoc_md30">Ingest Settings</a></li>
<li class="level2"><a href="#autotoc_md31">Seeing Results</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="autotoc_md26"></a>
What Does It Do</h1>
<p>The Hash Lookup Module calculates MD5 hash values for files and looks up hash values in a database to determine if the file is notable, known (in general), included in a specific set of files, or unknown. SHA-256 hashes are also calculated, though these will not be used in hash set lookups.</p>
<h1><a class="anchor" id="autotoc_md27"></a>
Configuration</h1>
<p>The Hash Sets tab on the Options panel is where you can set and update your hash set information. Hash sets are used to identify files that are 'known', 'notable', or 'no change'. </p><ul>
<li>Known good files are those that can be safely ignored. This set of files frequently includes standard OS and application files. Ignoring such uninteresting-to-the-investigator files, can greatly reduce image analysis time. </li>
<li>Notable (or known bad) files are those that should raise awareness. This set will vary depending on the type of investigation, but common examples include contraband images and malware. </li>
<li>No change files are files that can reveal information about the system but are not notable. For example, knowning an image contains many files known to be maps of London could be interesting to an investigator, but the maps themselves are not notable.</li>
</ul>
<h1><a class="anchor" id="adding_hashsets"></a>
Importing Hash Sets</h1>
<p>To import an existing hash set, use the "Import Database" button on the Hash Sets options panel. This will bring up a dialog to import the file.</p>
<div class="image">
<img src="hash_import.png" alt=""/>
</div>
<p><b>Database Path</b> - The path to the hash set you are importing. Autopsy supports the following formats: </p><ul>
<li>Text: One hash starting each line. For example, the output from running the md5, md5sum, or md5deep program on a set of files (*.txt) </li>
<li>Index only: Generated by Sleuth Kit/Autopsy. The NSRL is available in this format for use with Autopsy (<a class="el" href="hash_db_page.html#using_hashsets">see below</a>) (*.idx) </li>
<li>Sleuth Kit/Autopsy format database: SQLite hash sets created by Autopsy (*.kdb) </li>
<li>EnCase: An EnCase hash set file (*.hash) </li>
<li>HashKeeper: Hash set file conforming to the HashKeeper standard (*.hsh)</li>
</ul>
<p><b>Destination</b> - The Destination field refers to where the hash set will be stored. </p><ul>
<li>Local: The hash set file will be used from original the location on disk </li>
<li>Remote: The hash set will be copied into the <a class="el" href="central_repo_page.html">central repository</a>. When using a PostgreSQL central repository, this allows multiple users to easily share the same hash sets.</li>
</ul>
<p><b>Name</b> - Display name of the hash set. One will be suggested based on the file name, but this can be changed.</p>
<p><b>Version</b> - The version of the hash set can only be entered when importing the hash set into the central repository. Additionally, no version can be entered if the hash set is not read-only.</p>
<p><b>Source Organization</b> - The organization can only be entered when importing the hash set into the central repository. See the section on <a class="el" href="central_repo_page.html#cr_manage_orgs">managing organizations</a> for more information.</p>
<p><b>Type of database</b> - All entries in the hash set should either be "known" (can be safely ignored), "notable" (could be indicators of suspicious behavior), or "no change" (known to be a certain type of file).</p>
<p><b>Make database read-only</b> - The read-only setting is only active when importing the hash set into the central repository. A read-only database can not have new hashes added to it through either the Hash Sets options panel or the context menu. For locally imported hash sets, whether they can be written to is dependent on the type of hash set. Autopsy format databases (*.kdb) can be edited, but all other types will be read-only.</p>
<p><b>Send ingest inbox message for each hit</b> - Determines whether a message is sent for each matching file. This can not be enabled for a "known" hash set.</p>
<p><b>Copy hash set into user configuration folder</b> - Makes a copy of the hash set instead of using the existing one. This is intended to be used with a <a class="el" href="live_triage_page.html">Creating a Live Triage Drive</a> drive.</p>
<h2><a class="anchor" id="hashset_indexing"></a>
Indexing</h2>
<p>After importing the hash set, you may have to index it before it can be used. For most hash set types, Autopsy needs an index of the hash set to actually use a hash set. It can create the index if you import only the hash set. Any hash sets that require an index will be displayed in red, and their "Index Status" will indicate that an index needs to be created. This is done simply by using the Index button.</p>
<div class="image">
<img src="hash_indexing.png" alt=""/>
</div>
<p>Autopsy uses the hash set management system from The Sleuth Kit. You can manually create an index using the 'hfind' command line tool or you can use Autopsy. If you attempt proceed without indexing a hash set, Autopsy will offer to automatically produce an index for you. You can also specify only the index file and not use the full hash set - the index file is sufficient to identify known files. This can save space. To do this, specify the .idx file from the Hash Sets option panel.</p>
<h1><a class="anchor" id="creating_hashsets"></a>
Creating Hash Sets</h1>
<p>New hash sets can be created using the "New Hash Set" button. The fields are mostly the same as the <a class="el" href="hash_db_page.html#adding_hashsets">import dialog</a> described above.</p>
<div class="image">
<img src="hash_new_db.png" alt=""/>
</div>
<p>In this case, the Database Path is where the new database will be stored. If the central repository is being used then this field is not needed.</p>
<h1><a class="anchor" id="hash_adding_hashes"></a>
Adding Hashes to a Hash Set</h1>
<p>Once you've created a hash set you'll need to add hashes two it. The first way to do this is using the "Add Hashes to Hash Set" button on the options panel. Each hash should be on its own line, and can optionally be followed by a comma and then a comment about the file that hash corresponds to. Here we are creating a "no change" hash set corresponding to cat images:</p>
<div class="image">
<img src="hash_add.png" alt=""/>
</div>
<p>The other way to add an entry to a hash set is through the context menu. Highlight the file you want to add to a hash set in the result viewer and right-click, then select "Add file to hash set" and finally the set you want to add it to. Note that this does not automatically add the file to the list of hash set hits for the current case - you will have to re-run the Hash Lookup ingest module to see it appear there.</p>
<div class="image">
<img src="hash_add_context.png" alt=""/>
</div>
<h1><a class="anchor" id="using_hashsets"></a>
Using Hash Sets</h1>
<p>There is an <a class="el" href="ingest_page.html">ingest module</a> that will hash the files and look them up in the hash sets. It will flag files that were in the notable hash set and those results will be shown in the Results tree of the <a class="el" href="tree_viewer_page.html">Tree Viewer</a>. Other ingest modules are able to use the known status of a file to decide if they should ignore the file or process it. You can also see the results in the <a class="el" href="file_search_page.html#how_to_open_file_search">File Search</a> window. There is an option to choose the 'known status'. From here, you can do a search to see all 'notable' files. From here, you can also choose to ignore all 'known' files that were found in the NSRL. You can also see the status of the file in a column when the file is listed. <br  />
 </p>
<h2><a class="anchor" id="autotoc_md28"></a>
NIST NSRL</h2>
<p>Autopsy can use the <a href="http://www.nsrl.nist.gov">NIST NSRL</a> to detect 'known files'. The NSRL contains hashes of 'known files' that may be good or bad depending on your perspective and investigation type. For example, the existence of a piece of financial software may be interesting to your investigation and that software could be in the NSRL. Therefore, Autopsy treats files that are found in the NSRL as simply 'known' and does not specify good or bad. Ingest modules have the option of ignoring files that were found in the NSRL.</p>
<p>To use the NSRL, you may download a pre-made index from <a href="http://sourceforge.net/projects/autopsy/files/NSRL/">http://sourceforge.net/projects/autopsy/files/NSRL</a>. Download the <b>NSRL-XYZm-autopsy.zip </b> (where 'XYZ' is the version number. As of this writing, it is 247) and unzip the file. Use the "Tools", "Options" menu and select the "Hash Sets" tab. Click "Import Database" and browse to the location of the unzipped NSRL file. You can change the Hash Set Name if desired. Select the type of database desired, choosing "Send ingest inbox message for each hit" if desired, and then click "OK".</p>
<p><br  />
 </p><div class="image">
<img src="nsrl_import_process.PNG" alt=""/>
</div>
<p> <br  />
</p>
<h1><a class="anchor" id="autotoc_md29"></a>
Using the Module</h1>
<h2><a class="anchor" id="autotoc_md30"></a>
Ingest Settings</h2>
<p>When hash sets are configured, the user can select the hash sets to use during the ingest process.</p>
<div class="image">
<img src="hash-lookup.PNG" alt=""/>
</div>
<h2><a class="anchor" id="autotoc_md31"></a>
Seeing Results</h2>
<p>Results show up in the tree as "Hashset Hits", grouped by the name of the hash set. If the hash set hits had associated comments, you will see them in the "Comment" column in the result viewer along with the file hash.</p>
<div class="image">
<img src="hashset-hits.PNG" alt=""/>
</div>
<p>You can also view the comments on the "Annotation" tab of the content viewer. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr/>
<p><i>Copyright &#169; 2012-2022 Basis Technology. Generated on Fri Feb 24 2023<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
