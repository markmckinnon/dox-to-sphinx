<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: Ad Hoc Keyword Search</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autopsy User Documentation<span id="projectnumber">&#160;4.19.3</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Autopsy User&#39;s Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Ad Hoc Keyword Search </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#ad_hoc_kw_overview">Overview</a></li>
<li class="level1"><a href="#ad_hoc_kw_types_section">Creating Keywords</a><ul><li class="level2"><a href="#autotoc_md0">Exact match</a></li>
<li class="level2"><a href="#autotoc_md1">Substring match</a></li>
<li class="level2"><a href="#autotoc_md2">Regex match</a></li>
<li class="level2"><a href="#autotoc_md3">Other notes</a><ul><li class="level3"><a href="#autotoc_md4">Built-in keywords</a></li>
<li class="level3"><a href="#autotoc_md5">Non-Latin text</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#ad_hoc_kw_search">Keyword Search</a></li>
<li class="level1"><a href="#ad_hoc_kw_lists">Keyword Lists</a></li>
<li class="level1"><a href="#ad_hoc_during_ingest">Doing ad hoc searches during ingest</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="ad_hoc_kw_overview"></a>
Overview</h1>
<p>The ad hoc keyword search features allows you to run single keyword terms or lists of keywords against all images in a case. Both options are located in the top right of the main Autopsy window.</p>
<div class="image">
<img src="keyword-search-ad-hoc.PNG" alt=""/>
</div>
<p>The <a class="el" href="keyword_search_page.html">Keyword Search Module</a> must be selected during ingest before doing an ad hoc keyword search. If you don't want to search for any of the existing keyword lists, you can deselect everything to just index the files for later searching.</p>
<h1><a class="anchor" id="ad_hoc_kw_types_section"></a>
Creating Keywords</h1>
<p>The following sections will give a description of each keyword type, then will show some sample text and how various search terms would work against it.</p>
<h2><a class="anchor" id="autotoc_md0"></a>
Exact match</h2>
<p>Exact match should be used in cases where the search term is expected to always be surrounded by non-word characters (typically whitespace or punctuation). Spaces/punctuation are allowed in the search term, and capitalization is ignored.</p>
<blockquote class="doxtable">
<p>&zwj;The quick reddish-brown fox jumps over the lazy dog. </p>
</blockquote>
<ul>
<li>"quick", "brown", "dog" will match</li>
<li>"FOX", "Fox", "fox" will all match</li>
<li>"reddish-brown fox", "brown fox", "LAZY DOG" will match</li>
<li>"rown" and "lazy do" will not match since they are not bounded by non-word characters in the text</li>
</ul>
<h2><a class="anchor" id="autotoc_md1"></a>
Substring match</h2>
<p>Substring match should be used where the search term is just part of a word, or to allow for different word endings. Capitalization is ignored but spaces and other punctuation can not appear in the search term.</p>
<blockquote class="doxtable">
<p>&zwj;The quick reddish-brown fox jumps over the lazy dog. </p>
</blockquote>
<ul>
<li>"jump" will match "jumps", and would also match "jumping", "jumped", etc.</li>
<li>"dog" will match</li>
<li>"UMP", "oX" will match</li>
<li>"y dog", "ish-brown" will not match</li>
</ul>
<h2><a class="anchor" id="autotoc_md2"></a>
Regex match</h2>
<p>Regex match can be used to search for a specific pattern. Regular expressions are supported using Lucene Regex Syntax which is documented here: <a href="https://www.elastic.co/guide/en/elasticsearch/reference/1.6/query-dsl-regexp-query.html#regexp-syntax">https://www.elastic.co/guide/en/elasticsearch/reference/1.6/query-dsl-regexp-query.html#regexp-syntax</a>. Wildcards are automatically added to the beginning and end of the regular expressions to ensure all matches are found. Additionally, the resulting hits are split on common token separator boundaries (e.g. space, newline, colon, exclamation point etc.) to make the resulting keyword hit more amenable to highlighting. As of Autopsy 4.9, regex searches are no longer case sensitive. This includes literal characters and character classes.</p>
<p><b>Note:</b> Since Autopsy 4.4, boundary characters ('^' and '$') no longer work as word boundaries. Previously a search for "^[0-9]{5}$" would return all five digit strings surrounded by some type of non-word characters. For example, "The number 12345 is.." would contain a match, while "123456789 people" would not. This was because the regex was compared against each "word" in the document. In newer versions, the text is not split into words internally so this type of search no longer works. To get similar results, replace the boundary characters with the specific characters that should represent a word break. For example, "^[0-9]{5}$" could become "[ \.\-\,][0-9]{5}[ \.\-\,]".</p>
<p>There is some validation on the regex but it's best to test on a sample image to make sure your regexes are correct and working as expected. One simple way to test is by creating a sample text file that your expression should match, ingesting it as a <a class="el" href="ds_page.html#ds_log">Logical File Set</a> and then running the regex query.</p>
<blockquote class="doxtable">
<p>&zwj;In the year 1885 in an article titled Current Notes, the quick brown fox first jumped over the lazy dog. </p>
</blockquote>
<ul>
<li>"fox" and "FOX" will both match since the search is case-insensitive</li>
<li>"qu.ck", "cu.*es" will match</li>
<li>"[JLK]umped" will match "jumped"</li>
<li>"[0-9]{4}" will match 1885. Character classes like "\d" are not supported. Backreferences are also not supported (but will not generate an error), so "Cu(.)\1ent" would not work to find "Current"</li>
</ul>
<h2><a class="anchor" id="autotoc_md3"></a>
Other notes</h2>
<h3><a class="anchor" id="autotoc_md4"></a>
Built-in keywords</h3>
<p>The <a class="el" href="keyword_search_page.html">Keyword Search Module</a> has several built-in searches that can not be edited. The ones that are most prone to false hits (IP Address and Phone Number) require that the matching text is surrounded by boundary characters, such as spaces or certain punctuation. For example:</p><ul>
<li>"Address 10.1.5.127 is unavailable" - The built-in IP Address search would find "10.1.5.127" because it is surrounded by whitespace</li>
<li>"abc10.1.7.99xyz" - The built-in IP Address search would not find it because it is surrounded by letters</li>
</ul>
<p>If you want to override this default behavior:</p><ul>
<li>Copy the existing regex. The easiest way to do this is to click on Keyword Lists, the list you want then the specific entry you want and hit control+c to copy. It will need a bit of cleanup afterward.</li>
<li>Remove the boundary characters on the beginning and end of the regex</li>
<li>Make a new keyword list containing the result and run it either during ingest or through the Keyword Lists button.</li>
</ul>
<h3><a class="anchor" id="autotoc_md5"></a>
Non-Latin text</h3>
<p>In general all three types of keyword searches will work as expected but the feature has not been thoroughly tested with all character sets. For example, the searches may no longer be case-insensitive. As with regex above, we suggest testing on a sample file.</p>
<h1><a class="anchor" id="ad_hoc_kw_search"></a>
Keyword Search</h1>
<p>Individual keyword or regular expressions can quickly be searched using the search text box widget. You can select "Exact Match", "Substring Match" and "Regular Expression" match. See the earlier <a class="el" href="ad_hoc_keyword_search_page.html#ad_hoc_kw_types_section">Creating Keywords</a> section for information on each keyword type. The search can be restricted to only certain data sources by selecting the checkbox near the bottom and then highlighting the data sources to search within. Multiple data sources can be selected used shift+left click or control+left click. The "Save search results" checkbox determines whether the search results will be saved to the case database.</p>
<div class="image">
<img src="keyword-search-bar.PNG" alt=""/>
</div>
<p>Results will be opened in a separate Results Viewer for every search executed. If the "Save search results" checkbox was enabled, the results will also be saved in the Directory Tree as shown in the screenshot below.</p>
<div class="image">
<img src="keyword-search-hits.PNG" alt=""/>
</div>
<h1><a class="anchor" id="ad_hoc_kw_lists"></a>
Keyword Lists</h1>
<p>In addition to being selected during ingest, keyword lists can also be run through the Keyword Lists button. For information on setting up these keyword lists, see the <a class="el" href="keyword_search_page.html#keyword_keywordListsTab">Lists tab</a> section of the ingest module documentation.</p>
<p>Lists created using the Keyword Search Configuration Dialog can be manually searched by the user by pressing on the 'Keyword Lists' button and selecting the check boxes corresponding to the lists to be searched. The search can be restricted to only certain data sources by selecting the checkbox near the bottom and then highlighting the data sources to search within. Multiple data sources can be selected used shift+left click or control+left click. Once everything has been configured, press "Search" to begin the search. The "Save search results" checkbox determines whether the search results will be saved to the case database.</p>
<div class="image">
<img src="keyword-search-list.PNG" alt=""/>
</div>
<p>If the "Save search results" checkbox was enabled, the results of the keyword list search will be shown in the tree, as shown below.</p>
<div class="image">
<img src="keyword-search-list-results.PNG" alt=""/>
</div>
<h1><a class="anchor" id="ad_hoc_during_ingest"></a>
Doing ad hoc searches during ingest</h1>
<p>Ad hoc searches are intended to be used after ingest completes, but can be used in a limited capacity while ingest is ongoing.</p>
<p>Manual <a class="el" href="ad_hoc_keyword_search_page.html#ad_hoc_kw_search">Keyword Search</a> for individual keywords or regular expressions can be executed while ingest is ongoing, using the current index. Note however, that you may miss some results if the entire index has not yet been populated. Autopsy enables you to perform the search on an incomplete index in order to retrieve some preliminary results in real-time.</p>
<p>During the ingest, the normal manual search using <a class="el" href="ad_hoc_keyword_search_page.html#ad_hoc_kw_lists">Keyword Lists</a> behaves differently than after ingest is complete. A selected list can instead be added to the ingest process and it will be searched in the background instead.</p>
<p>Most keyword management features are disabled during ingest. You can not edit keyword lists but can create new lists (but not add to them) and copy and export existing lists. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr/>
<p><i>Copyright &#169; 2012-2022 Basis Technology. Generated on Fri Feb 24 2023<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
