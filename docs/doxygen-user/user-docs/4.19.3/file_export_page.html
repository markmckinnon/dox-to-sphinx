<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: File Export</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autopsy User Documentation<span id="projectnumber">&#160;4.19.3</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">File Export </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#file_export_overview">Overview</a></li>
<li class="level1"><a href="#file_export_setup">Configuration</a><ul><li class="level2"><a href="#file_exporter_mime">MIME Type</a></li>
<li class="level2"><a href="#file_exporter_size">File Size</a></li>
<li class="level2"><a href="#file_exporter_attributes">Attributes</a></li>
</ul>
</li>
<li class="level1"><a href="#file_export_output">Output</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="file_export_overview"></a>
Overview</h1>
<p>If enabled, the File Exporter will run after each <a class="el" href="auto_ingest_page.html">Automated Ingest</a> job and export any files from that data source that match the supplied rules. Most users will not need to use this feature - analysts can open the auto ingest cases in an examiner node and look through the data there.</p>
<h1><a class="anchor" id="file_export_setup"></a>
Configuration</h1>
<p>After enabling the file exporter, the first thing to do is set two output folders. The "Files Folder" is the base directory for all exported files, and the "Reports Folder" is the base directory for reports (lists of every file exported for each data source). If possible, it is best to use UNC paths.</p>
<div class="image">
<img src="file_exporter_main.png" alt=""/>
</div>
<p>Next you'll make rules for the files you want to export. Each rule must have a name and at least one condition set. If more than one condition is set, then all conditions must be true to export the file. When you're done setting up your rule, press the "Save" button to save it. You'll see the new rule in the list on the left side.</p>
<p>All of the saved rules will be run against each data source. There's no way to set a rule as inactive, so if you make a rule and don't want it to run you'll have to use the "Delete Rule" button to remove it.</p>
<p>You'll need to run at the <a class="el" href="hash_db_page.html">Hash Lookup Module</a> and <a class="el" href="file_type_identification_page.html">File Type Identification Module</a> to use the file exporter. You may need to run additional modules based on any attributes in your rules.</p>
<h2><a class="anchor" id="file_exporter_mime"></a>
MIME Type</h2>
<p>The first condition is based on MIME type. To enable it, check the box before "MIME Type", then select a MIME type from the list and choose whether you want to match it or not match it. Multiple MIME types can not be selected at this time. The following shows a rule that will match all PNG images.</p>
<div class="image">
<img src="file_export_png.png" alt=""/>
</div>
<h2><a class="anchor" id="file_exporter_size"></a>
File Size</h2>
<p>The second condition is based on file size. You can choose a file size (using the list on the right to change the units) and then select whether files should be larger, smaller, equal to, or not equal to that size. The following shows a rule that will match plain text files that are over 1kB.</p>
<div class="image">
<img src="file_export_size.png" alt=""/>
</div>
<h2><a class="anchor" id="file_exporter_attributes"></a>
Attributes</h2>
<p>The third condition is based on blackboard artifacts and attributes, which is how Autopsy stores most of its analysis results. A file will be exported if it is linked to a matching attribute. Using this type of condition will require some familiarity with exactly how these attributes are being created and what data we expect to see in them. There's some information to get started in the <a href="http://sleuthkit.org/sleuthkit/docs/jni-docs/4.6.0/mod_bbpage.html">Sleuthkit documentation</a>. You will most likely also have to open an Autopsy database file to verify the exact attribute types being used to hold the data you're interested in.</p>
<p>To make an attribute condition, select the artifact type and then the attribute type that you are interested in. On the next line you can enter a value and set what relation you want the attribute to have to it (equals, not equals, greater/less than). Not all options will make sense with all data types. Then use the "Add Attribute" button to add it to the attribute list. If you make a mistake, use the "Delete Attribute" button to erase it. The following shows a rule that will export any files that had a keyword hit for the word "bomb" in them.</p>
<div class="image">
<img src="file_export_keyword.png" alt=""/>
</div>
<p>It's possible to do more general matching on the artifacts. Suppose you wanted to export all files that the <a class="el" href="encryption_page.html">Encryption Detection Module</a> flagged as "Encryption Suspected". These files will have a TSK_ENCRYPTION_SUSPECTED artifact with a single "TSK_COMMENT" attribute that contains the entropy calculated for the file. In this case we can use the "not equals" operator on a string that we wouldn't expect to see in the TSK_COMMENT field to effectively change the condition to "has an associated TSK_ENCRYPTION_SUSPECTED artifact."</p>
<div class="image">
<img src="file_export_encrypton.png" alt=""/>
</div>
<h1><a class="anchor" id="file_export_output"></a>
Output</h1>
<p>The exported files are found under the files folder that was specified in the <a class="el" href="file_export_page.html#file_export_setup">Configuration</a> step and then organized at the top layer by the device ID of the data source.</p>
<div class="image">
<img src="file_export_dir_structure.png" alt=""/>
</div>
<p>Exported files are named with their hash and stored in subfolders based on parts of that hash, to prevent any single folder from becoming very large.</p>
<div class="image">
<img src="file_export_file_loc.png" alt=""/>
</div>
<p>The report files are also found in subfolders under the device ID and then the rule name.</p>
<div class="image">
<img src="file_export_json_loc.png" alt=""/>
</div>
<p>This json file will contain information about the file, and any associated artifact that was part of the rule's conditions. </p><pre class="fragment">{"7C89F280C337AB3E997D20527B8EC6F8":{"Filename":"\\\\WIN-4913\\AutopsyData\\FileExportFiles\\37567\\text-plain\\7C\\89\\F2\\80\\7C89F280C337AB3E997D20527B8EC6F8",
"Type":"text/plain","MD5":"7C89F280C337AB3E997D20527B8EC6F8","File data":{"Modified":["0000-00-00 00:00:00"],"Changed":["0000-00-0000:00:00"],
"Accessed":["0000-00-00 00:00:00"],"Created":["0000-00-00 00:00:00"],"Extension":["txt"],"Filename":["File about explosions.txt"],"Size":["54"],
"Source Path":["/kwTest_2019_03_14_12_53_33//File about explosions.txt"],"Flags (Dir)":["Allocated"],"Flags (Meta)":["Allocated"],
"Mode":["r---------"],"User ID":["0"],"Group ID":["0"],"Meta Addr":["0"],"Attr Addr":["1-0"],"Dir Type":["r"],"MetaType":["r"],
"Known":["unknown"]},"TSK_KEYWORD_HIT":{"TSK_KEYWORD":["bomb"]},
"TSK_KEYWORD_HIT":{"TSK_KEYWORD_PREVIEW":["keyword search for the word bomb in this file.\n\n\n------"]},
"TSK_KEYWORD_HIT":{"TSK_SET_NAME":["bomb"]},"TSK_KEYWORD_HIT":{"TSK_KEYWORD_SEARCH_TYPE":["0"]}}}
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<hr/>
<p><i>Copyright &#169; 2012-2022 Basis Technology. Generated on Fri Feb 24 2023<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
