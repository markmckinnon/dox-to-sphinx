<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Autopsy User Documentation: Install and Configure ActiveMQ</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Autopsy User Documentation<span id="projectnumber">&#160;4.19.3</span>
   </div>
   <div id="projectbrief">Graphical digital forensics platform for The Sleuth Kit and other tools.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Install and Configure ActiveMQ </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="install_activemq_overview"></a>
Overview</h1>
<p>ActiveMQ is a messaging service that allows the Autopsy clients to communicate with each other. This allows each client to get real-time updates. This service has minimal storage requirements.</p>
<h1><a class="anchor" id="install_activemq_prereq"></a>
Prerequisites</h1>
<p>You will need:</p><ul>
<li>64-bit version of the Java 8 Runtime Environment (JRE) from <a href="https://github.com/ojdkbuild/ojdkbuild">https://github.com/ojdkbuild/ojdkbuild</a> (<a href="https://github.com/ojdkbuild/ojdkbuild/releases/download/java-1.8.0-openjdk-1.8.0.242-1.b08/java-1.8.0-openjdk-1.8.0.242-1.b08.ojdkbuild.windows.x86_64.msi">Link to installer</a>)</li>
<li>Download ActiveMQ from: <a href="http://activemq.apache.org/download.html">http://activemq.apache.org/download.html</a> . Autopsy has been tested with ActiveMQ version 5.14.0. Note that newer versions will not work with Java 8.</li>
</ul>
<h1><a class="anchor" id="install_activemq_install"></a>
Installation</h1>
<h2><a class="anchor" id="install_activemq_install_java"></a>
JRE Installation</h2>
<p>Install the Java JRE if needed. You can test this by running <em>where java</em> from the command line. If you see output similar to the results below, you have a JRE. <br  />
<br  />
 </p><div class="image">
<img src="wherejava.PNG" alt=""/>
</div>
<p> <br  />
<br  />
 <br  />
 If you need the JRE, install it with the default settings.</p>
<h2><a class="anchor" id="install_activemq_install_mq"></a>
ActiveMQ Installation</h2>
<ol>
<li>
<p class="startli">Extract the contents of the ActiveMQ archive to a location of your choice, bearing in mind that the files should be in a location where the running process has write permissions. A typical folder choice would be similar to <em>C:\Program Files\apache-activemq-5.13.3</em>. The system may ask for administrator permission to move the folder. Allow it if required.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Open the <em>conf\activemq.xml</em> file in the extracted folder in a text editor and make the following changes: </p><ul>
<li>
Add <em>"schedulePeriodForDestinationPurge="10000""</em> to the <em>broker</em> tag </li>
<li>
Add <em>"gcInactiveDestinations="true" inactiveTimoutBeforeGC="30000""</em> to the <em>policyEntry</em> tag. </li>
<li>
<p class="startli">These are both highlighted in yellow below:</p>
<div class="image">
<img src="activeMQ_node_cleanup.png" alt=""/>
</div>
<p class="endli"></p>
</li>
<li>
Add <em>"&amp;amp;wireFormat.maxInactivityDuration=0"</em> to the URI for the <em>transportConnector</em> named <em>openwire</em>. This is highlighted in yellow below: <br  />
<br  />
 <div class="image">
<img src="maxinactivityduration.PNG" alt=""/>
</div>
 <br  />
<br  />
 </li>
</ul>
<p class="endli"></p>
</li>
<li>
<p class="startli">Install ActiveMQ as a service by navigating to the folder <em>bin\win64</em>, right-clicking <em>InstallService.bat</em>, clicking <em>Run as administrator</em>, then click <em>Yes</em>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Add the bin\win64\wrapper.exe and java.exe (from the JRE) to the Windows firewall so that they can accept network communications.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Start the ActiveMQ service by pressing <em>Start</em>, type <em>services.msc</em>, and press <em>Enter</em>. Find <em>ActiveMQ</em> in the list and press the <em>Start the service</em> link.</p>
<p class="endli"></p>
</li>
<li>
ActiveMQ should now be installed and configured using the default credentials. </li>
</ol>
<h2><a class="anchor" id="install_activemq_test"></a>
Testing</h2>
<p>To test your installation, you can access the admin pages in your web browser (on the server) via a URL like this: <a href="http://localhost:8161/admin">http://localhost:8161/admin</a>. NOTE that you cannot access this page from other hosts unless you go into jetty.xml and change org.apache.activemq.web.WebConsolePort so that host is 0.0.0.0 (and ensure that it is properly secured).</p>
<p>The default administrator username is <em>admin</em> with a password of <em>admin</em> and the default regular username is <em>user</em> with a default password of <em>password</em>. You can change these passwords by following the instructions below.</p>
<p>If you can see a page that looks like the following, it confirms that the ActiveMQ service is running locally but it does not necessarily mean that the service is visible to other computers on the network. <br  />
<br  />
 </p><div class="image">
<img src="activemq.PNG" alt=""/>
</div>
<p> <br  />
<br  />
</p>
<p>You can also confirm that your ActiveMQ installation is visible to other computers on the network by attempting to connect to a URL like the following (replacing the host name with that of the ActiveMQ computer) in a web browser: <a href="http://activemq-computer:61616">http://activemq-computer:61616</a>. This will not give you a nice web page, but will give you data from the server.</p>
<p>If you are unable to connect to this address:</p><ul>
<li>Double check that the ActiveMQ service is running</li>
<li>Check that the port (61616) is not being blocked by a firewall.</li>
</ul>
<h1><a class="anchor" id="install_activemq_install_pw"></a>
Configuring Authentication</h1>
<p>You can optionally add authentication to your ActiveMQ server. The ActiveMQ communications are not encrypted and contain basic messages between the systems about when new data has been found.</p>
<p>The following directions allow you to set up credentials:</p>
<ol type="1">
<li>Copy and paste the following text to the file <em>"conf\groups.properties"</em>, overwriting the text highlighted in yellow in the screenshot below: <blockquote class="doxtable">
<p>admins=system,sslclient,client,broker1,broker2<br  />
 tempDestinationAdmins=system,user,sslclient,client,broker1,broker2<br  />
 users=system,user,sslclient,client,broker1,broker2<br  />
 guests=guest<br  />
 </p>
</blockquote>
<br  />
 <br  />
<br  />
 <div class="image">
<img src="groups.properties.before.PNG" alt=""/>
</div>
 <br  />
<br  />
 When complete, the file should look like this: <br  />
 <br  />
<br  />
 <div class="image">
<img src="groups.properties.after.PNG" alt=""/>
</div>
 <br  />
<br  />
 <br  />
</li>
<li>Copy and paste the following text to the file <em>"conf\users.properties"</em>, overwriting the text highlighted in yellow in the screenshot below: <blockquote class="doxtable">
<p><br  />
 system=manager<br  />
 user=password<br  />
 guest=password<br  />
 sslclient=CN=localhost, OU=activemq.org, O=activemq.org, L=LA, ST=CA, C=US<br  />
 </p>
</blockquote>
<br  />
 <br  />
<br  />
 <div class="image">
<img src="users.properties.before.PNG" alt=""/>
</div>
 <br  />
<br  />
 <br  />
 When complete, the file should look like this: <br  />
 <br  />
<br  />
 <div class="image">
<img src="users.properties.after.PNG" alt=""/>
</div>
 <br  />
<br  />
 <br  />
</li>
<li>Copy and paste the following text to the file <em>"conf\activemq.xml"</em>, inserting the text at the line shown in yellow in the screenshot below. <pre class="fragment">     &lt;plugins&gt;
     &lt;jaasAuthenticationPlugin configuration="activemq-domain" /&gt;
         &lt;simpleAuthenticationPlugin&gt;
             &lt;users&gt;
                 &lt;authenticationUser username="system" password="manager" groups="users,admins"/&gt;
                 &lt;authenticationUser username="user" password="password" groups="users"/&gt;
                 &lt;authenticationUser username="guest" password="password" groups="guests"/&gt;
             &lt;/users&gt;
         &lt;/simpleAuthenticationPlugin&gt;
     &lt;/plugins&gt;
</pre> <br  />
<br  />
 <div class="image">
<img src="insertTextHere.PNG" alt=""/>
</div>
 <br  />
<br  />
 After insertion, the file should look like the screenshot below, with the inserted portion highlighted in yellow. This is where you can change the username and password for your ActiveMQ setup. <br  />
<br  />
 <div class="image">
<img src="insertedText.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
</ol>
<p>To add a new user or change the password:</p>
<ol type="1">
<li>Stop the ActiveMQ service by pressing <em>Start</em>, type <em>services.msc</em>, and press <em>Enter</em>. Find <em>ActiveMQ</em> in the list and press the <em>Stop the service</em> link. <br  />
<br  />
 <div class="image">
<img src="StopActiveMQService.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Edit <em>"conf\activemq.xml"</em> adding the desired line. Both <em>username</em> and <em>password</em> are case sensitive. You will very likely want to keep your new users in the <em>users</em> group. <br  />
<br  />
 <div class="image">
<img src="newUserAndPassword.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
<li>Start the ActiveMQ service by pressing <em>Start</em>, type <em>services.msc</em>, and press <em>Enter</em>. Find <em>ActiveMQ</em> in the list and press the <em>Start the service</em> link. <br  />
<br  />
 <div class="image">
<img src="StartActiveMQService.PNG" alt=""/>
</div>
 <br  />
<br  />
</li>
</ol>
<h1><a class="anchor" id="install_mq_backup"></a>
Backing Up</h1>
<p>There is nothing to backup for ActiveMQ. It does not store any case-related data in files. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<hr/>
<p><i>Copyright &#169; 2012-2022 Basis Technology. Generated on Fri Feb 24 2023<br/> 
This work is licensed under a
<a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/us/">Creative Commons Attribution-Share Alike 3.0 United States License</a>.
</i></p>
</body>
</html>
